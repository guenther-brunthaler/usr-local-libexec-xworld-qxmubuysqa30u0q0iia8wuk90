#! /bin/sh
# Use the following command to integrate this script with git:
# $ git config --global core.editor /usr/local/libexec/xworld/git-joe-editor
set -e
t=
cleanup() {
	test -n "$t" && { rm -- "$t"; t=; }
}
trap 'cleanup; echo "Failed!" >& 2' 0
test x"$#" = x1
t=`tempfile`
cat <<- 'EOF' > "$t"
#Headline is capitalized and not longer than this
#################################################

#######################################################################
#Body text lines should not be longer than the line before this one.
#Write your commit message in the imperative: "Fix bug" and not "Fixed
#bug" or "Fixes bug". This is consistent with autogenerated entries.
EOF
cat -- "$@" >> "$t"
cat "$t" > "$1"
cleanup
l=`locale | sed -e 's,^LANG=,,; t; d'`
cs=${l##*.}
test -x"$cs" != x"$l" || cs=
l=en_US.${cs:-utf8}
exec joe -language "$l" -rmargin 72 -wordwrap -- +3 "$@"
