#! /bin/sh
# Use the following command to integrate this script with git:
# $ git config --global core.editor /usr/local/libexec/xworld/git-joe-editor
set -e
t=
cleanup() {
	test -n "$t" && { rm -- "$t"; t=; }
}
trap 'cleanup; echo "Failed!" >& 2' 0
test x"$#" = x1
t=`mktemp "${TMPDIR:-/tmp}/${0##*/}.XXXXXXXXXX"`
cat <<- 'EOF' > "$t"
#Headline is capitalized and not longer than this:
##################################################

########################################################################
#Body text lines should not be longer than the line before this one.
#Write your commit message in the imperative: "Fix bug" and not "Fixed
#bug" or "Fixes bug". This is consistent with autogenerated entries.
EOF
cat -- "$@" >> "$t"
cat "$t" > "$1"
cleanup
l=`locale | sed -e 's,^LANG=,,; t; d'`
cs=${l##*.}
test -x"$cs" != x"$l" || cs=
l=en_US.${cs:-utf8}
n=$#
while test $n != 0
do
	case $1 in
		--) ;;
		-) set -- "$@" "$1";;
		-*) set -- "$@" ./"$1";;
		*) set -- "$@" "$1"
	esac
	shift
	n=`expr $n - 1 || :`
done
exec joe -language "$l" -rmargin 73 -wordwrap +3 "$@"
